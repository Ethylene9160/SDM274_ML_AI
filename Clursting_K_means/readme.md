K-means on clursting



## loss function:

$$
J(c,\mu)=\sum_{i=1}^M||x_i-\mu_{c_i}||^2
$$

其中，x~i~代表第i个样本，c~i~代表x~i~所属的簇，$\mu_{c_i}$代表簇的中心点，M为样本总数。



方法

KMeans的核心目标是将给定的数据集划分成K个簇（K是超参），并给出每个样本数据对应的中心点。具体步骤非常简单，可以分为4步：

（1）数据预处理。主要是标准化、异常点过滤。

（2）随机选取K个中心，记为 $\mu_1^{(0)},\mu_2^{(0)},...,\mu_k^{(0)}$

（3）定义[损失函数](##loss function)

（4）令t=0,1,2,... 为迭代步数，重复如下过程直到损失函数收敛：

> 对于每个样本$x_i$, 将其分配到距离最近的中心：
> $$
> c_i^{(t)}=-argmin_k||x_i-\mu_k^{(t)}||^2
> $$
> 对每个类的中心，重新计算其中心：
> $$
> \mu_k^{(k+1)}=-argmin_\mu\sum_{i:c_i^t=k}^b||x_i-\mu||^2
> $$

通常，距离的计算采用<font color = blue>欧式距离。</font>
$$
d(\pmb x,\pmb y)=\sqrt{\sum_{i=1}^n(x_i-y_i)^2}
$$
**KMeans最核心的部分就是先固定中心点，调整每个样本所属的类别来减少 损失函数；再固定每个样本的类别，调整中心点继续减小损失函数 。两个过程交替循环， 损失函数单调递减直到最（极）小值，中心点和样本划分的类别同时收敛。**

### 如何更新中心点坐标？

回忆calculus中，对中心点的计算，可以知道，某个集合中离散点集合的中心点的计算方法可以表示为：
$$
\mu_j=\frac{
	\sum_{i=1}^mx^{(j)}
}{
m
}
$$
其中，j表示dimension下坐标某个维度的值，m表示该分类下的样本总数。

## features of Kmeans

* 优点：
> 计算复杂度为o(n)(即**o(NKt)**, N为数据量，K为聚类总数，t为迭代轮数)，高效。
> 收敛快，可解释性强。

* 缺点：
> 受初始值和异常点影响，聚类结果可能不是全局最优而是局部最优。
> K是超参数，一般需要按经验选择。
>  样本点只能划分到单一的类中。



## 优化方法

* 归一化
* 选择合适的K
* 改变初始值
* 采用核函数